<!-- upload.html -->
<input type="file" id="csvFile" />
<button onclick="upload()">Upload to Server</button>

<script>
const BACKEND_URL = "https://script.google.com/macros/s/xxx/exec"; // Replace with your script URL

function upload() {
  const fileInput = document.getElementById('csvFile');
  const file = fileInput.files[0];
  if (!file) return alert("Choose a file");

  const reader = new FileReader();
  reader.onload = function (e) {
    const lines = e.target.result.split("\n").filter(Boolean);
    const customers = lines.slice(1).map(line => {
      const [CUSTOMER_NBR, NAME] = line.split(',');
      return { CUSTOMER_NBR: CUSTOMER_NBR.trim(), PAID: false, NAME: NAME?.trim() || "" };
    });

    fetch(BACKEND_URL, {
      method: "POST",
      body: JSON.stringify({ action: "uploadCustomers", customers }),
      headers: { "Content-Type": "application/json" }
    })
    .then(res => res.text())
    .then(res => alert("Uploaded: " + res));
  };

  reader.readAsText(file);
}
</script>
